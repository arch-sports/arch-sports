file_name
# Read data from summary_data csv
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$Name)
tests          <- data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
data           <- read.csv(file = file_name)
athletes       <- unique(data$Name)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$Name %in% athletes,] %>%
arrange(Name)
# Read data from summary_data csv
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$NAME)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(Name)
tests          <- full_data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(NAME)
full_data$Date <- as.Date(full_data$Date)
full_data$Date <- as.Date(full_data$DATE)
tests          <- full_data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
source("C:/Users/Caitie Mayo/Desktop/GitHub/arch-sports/Monthly Report/monthly_report.R")
# Import testing data
test_url <- 'https://docs.google.com/spreadsheets/d/1VzdlsDCA-X8HVKvUktG1A5XZNiq3IuOwX2Zbq8k6Iu0/edit?gid=2006047091#gid=2006047091'
test_sheet <- 'MASTER DATA TABLE'
file_name <- paste('./', year(Sys.Date()),'_', month(Sys.Date()), '_testing_data.csv', sep = '')
if (!file.exists(file_name)) {
data <- read_sheet(test_url, sheet = test_sheet)
data <- data %>%
mutate(YOUNG      = ifelse(data$AGE <= 13, 1, 0),
OLD        = ifelse(data$AGE> 13 & data$AGE <= 18, 1, 0),
ADULT      = ifelse(data$AGE > 18, 1, 0),
DATE_MONTH = month(DATE),
NORDBORD   = rowMeans(cbind(data$NORDBORD_L, data$NORDBORD_R), na.rm = TRUE)) %>%
write.csv(file = file_name,
row.names = FALSE)
} else {
data <- read.csv(file = file_name)
}
find_min <- c('PRO_AGILITY', 'SPLIT_10', 'SPRINT_20', 'SHUTTLE_300')
# Get last month's and this month's testing data
data_last    <- data[month(data$DATE) == month(Sys.Date()) - 1,]
data_current <- data[month(data$DATE) == month(Sys.Date()),]
# Get athletes who tested last month
athletes <- unique(data_current$NAME)
# Create function list for summary table
func_list <- list(
Current = ~last(.x, na_rm = TRUE),
Best = ~max(.x, na.rm = TRUE),
Best_change = ~(last(.x, na_rm = TRUE) - max(.x, na.rm = TRUE)),
Best_perc = ~((last(.x, na_rm = TRUE) - max(.x, na.rm = TRUE))/max(.x, na.rm = TRUE)),
Last = ~nth(.x, -2, na_rm = TRUE),
Last_change = ~(last(.x, na_rm = TRUE) - nth(.x, -2, na_rm = TRUE)),
Last_perc = ~((last(.x, na_rm = TRUE) - nth(.x, -2, na_rm = TRUE))/nth(.x, -2, na_rm = TRUE))
)
# Create variable list for summary table
var_list <- c(
'NAME',
'DATE',
'DATE_MONTH',
'AGE',
'CMJ_FLIGHT',
'IMTP_PEAK',
'YOUNG',
'OLD',
'ADULT',
'DSI',
'NORDBORD_DIFF',
'NORDBORD_L',
'NORDBORD_R'
)
summary_data <- data %>%
select(-YOUNG, - OLD, -ADULT) %>%
group_by(NAME) %>%
summarise_at(
.vars = names(data)[!names(data) %in% var_list],
.funs = func_list
) %>%
filter(NAME %in% athletes)
data %>%
mutate(YOUNG      = ifelse(data$AGE <= 13, 1, 0),
OLD        = ifelse(data$AGE> 13 & data$AGE <= 18, 1, 0),
ADULT      = ifelse(data$AGE > 18, 1, 0),
DATE_MONTH = month(DATE),
NORDBORD   = rowMeans(cbind(data$NORDBORD_L, data$NORDBORD_R), na.rm = TRUE)) %>%
write.csv(file = file_name,
row.names = FALSE)
data <- read_sheet(test_url, sheet = test_sheet)
data %>%
mutate(YOUNG      = ifelse(data$AGE <= 13, 1, 0),
OLD        = ifelse(data$AGE> 13 & data$AGE <= 18, 1, 0),
ADULT      = ifelse(data$AGE > 18, 1, 0),
DATE_MONTH = month(DATE),
NORDBORD   = rowMeans(cbind(data$NORDBORD_L, data$NORDBORD_R), na.rm = TRUE)) %>%
write.csv(file = file_name,
row.names = FALSE)
if (!file.exists(file_name)) {
data <- read_sheet(test_url, sheet = test_sheet)
data %>%
mutate(YOUNG      = ifelse(data$AGE <= 13, 1, 0),
OLD        = ifelse(data$AGE> 13 & data$AGE <= 18, 1, 0),
ADULT      = ifelse(data$AGE > 18, 1, 0),
DATE_MONTH = month(DATE),
NORDBORD   = rowMeans(cbind(data$NORDBORD_L, data$NORDBORD_R), na.rm = TRUE)) %>%
write.csv(file = file_name,
row.names = FALSE)
} else {
data <- read.csv(file = file_name)
}
find_min <- c('PRO_AGILITY', 'SPLIT_10', 'SPRINT_20', 'SHUTTLE_300')
# Get last month's and this month's testing data
data_last    <- data[month(data$DATE) == month(Sys.Date()) - 1,]
data_current <- data[month(data$DATE) == month(Sys.Date()),]
# Get athletes who tested last month
athletes <- unique(data_current$NAME)
# Create function list for summary table
func_list <- list(
Current = ~last(.x, na_rm = TRUE),
Best = ~max(.x, na.rm = TRUE),
Best_change = ~(last(.x, na_rm = TRUE) - max(.x, na.rm = TRUE)),
Best_perc = ~((last(.x, na_rm = TRUE) - max(.x, na.rm = TRUE))/max(.x, na.rm = TRUE)),
Last = ~nth(.x, -2, na_rm = TRUE),
Last_change = ~(last(.x, na_rm = TRUE) - nth(.x, -2, na_rm = TRUE)),
Last_perc = ~((last(.x, na_rm = TRUE) - nth(.x, -2, na_rm = TRUE))/nth(.x, -2, na_rm = TRUE))
)
# Create variable list for summary table
var_list <- c(
'NAME',
'DATE',
'DATE_MONTH',
'AGE',
'CMJ_FLIGHT',
'IMTP_PEAK',
'YOUNG',
'OLD',
'ADULT',
'DSI',
'NORDBORD_DIFF',
'NORDBORD_L',
'NORDBORD_R'
)
summary_data <- data %>%
select(-YOUNG, - OLD, -ADULT) %>%
group_by(NAME) %>%
summarise_at(
.vars = names(data)[!names(data) %in% var_list],
.funs = func_list
) %>%
filter(NAME %in% athletes)
summary_data[summary_data == -Inf] <- NA
summary_data[summary_data == Inf] <- NA
write.csv(summary_data,
file = paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv', sep = ''),
row.names = FALSE)
# Read data from summary_data csv
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$NAME)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(NAME)
full_data$Date <- as.Date(full_data$DATE)
tests          <- full_data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
test <- 'BROAD_JUMP'
test_best_perc <- paste(test, '_Best_perc', sep = '')
data %>% mutate(test_best_perc = test_best_perc)
install.packages('glue')
multipetal <- function(df, n) {
varname <- paste("petal", n , sep=".")
df[[varname]] <- with(df, Petal.Width * n)
df
}
df <- data.frame()
multipetal(df, 10)
multipetal(iris, 10)
hw <- 'CMJ_IMP_MOM'
tests <- hw
test_current <- paste(test, '_Current', sep = '')
test_best_perc <- paste(test, '_Best_perc', sep = '')
test_last_perc <- paste(test, '_Last_perc', sep = '')
test_athletes <- unique(data$NAME[!is.na(data[test_current])])
test_data <- full_data[full_data$NAME %in% test_athletes,]
split_data <- split(test_data[test], test_data$NAME)
data[[test_best_perc]] <- data[[test_best_perc]] * 100
data[[test_last_perc]] <- data[[test_last_perc]] * 100
source("C:/Users/Caitie Mayo/Desktop/GitHub/arch-sports/Monthly Report/monthly_report.R")
View(data)
source("C:/Users/Caitie Mayo/Desktop/GitHub/arch-sports/Monthly Report/monthly_report.R")
test_current <- 'BROAD_JUMP_Current'
data[test_current]
data[[test_current]]
View(data)
summary_data[[test_current]]
summary_data[test_current]
summary_data[!is.na(summary_data[test_current]),]
# Read data from summary_data csv
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$NAME)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(NAME)
full_data$Date <- as.Date(full_data$DATE)
tests          <- full_data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
test <- 'CMJ_IMP_MOM'
test_current <- paste(test, '_Current', sep = '')
test_best_perc <- paste(test, '_Best_perc', sep = '')
test_last_perc <- paste(test, '_Last_perc', sep = '')
test_athletes <- unique(summary_data$NAME[!is.na(summary_data[test_current])])
test_data <- full_data[full_data$NAME %in% test_athletes,]
split_data <- split(test_data[test], test_data$NAME)
data[[test_best_perc]] <- data[[test_best_perc]] * 100
data[[test_last_perc]] <- data[[test_last_perc]] * 100
data[!is.na(data[test_current]),] %>%,
data[!is.na(data[test_current]),] %>%
cbind("Trend" = "") %>%,
data[!is.na(data[test_current]),] %>%
cbind("Trend" = "") %>%
select(
NAME,
Trend,
starts_with(test)) %>%
kable(
digits = 2,
row.names = FALSE,
col.names = c("Name",
"Trend",
"Current",
"Best",
"Best Change",
"Best % Change",
"Previous",
"Previous Change",
"Previous % Change",
)
) %>%
kable_styling(
full_width = TRUE,
fixed_thead = TRUE,
) %>%
column_spec(2, image = spec_plot(split_data, same_lim = FALSE))
data
summary_data
# Read data from summary_data csv
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$NAME)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(NAME)
full_data$Date <- as.Date(full_data$DATE)
tests          <- full_data %>%
select(-NAME,
-DATE,
-AGE,
-IMTP_PEAK,
-DATE_MONTH,
-NORDBORD_L,
-NORDBORD_R,
-NORDBORD_DIFF,
-DSI,
-OLD,
-YOUNG,
-ADULT,
-CMJ_FLIGHT) %>%
names()
unique(summary_data$NAME[!is.na(summary_data[test_current])])
unique(full_data$NAME[!is.na(full_data[test_current])])
test_current <- 'BROAD_JUMP_Current'
unique(full_data$NAME[!is.na(full_data[test_current])])
full_data
data[test_current]
test_athletes <- unique(data$NAME[!is.na(data[test_current])])
base::unique(data$NAME[!is.na(data[test_current])])
base::unique(data$NAME[!is.na(data[[test_current]])])
data[!is.na(data[[test_current]]),]
data[!is.na(data[[test_current]]),] %>% cbind("Trend" = "")
test <- 'BROAD_JUMP'
data[!is.na(data[[test_current]]),] %>% cbind("Trend" = "") %>% select(NAME, Trend, starts_with(test))
#| output: asis
res <- purrr::map_chr(tests, \(hw) {
knitr::knit_child(text = c(
"## `r hw`",
"",
"```{r}",
'test <- hw',
'test_current <- paste(test, "_Current", sep = "")',
'test_best_perc <- paste(test, "_Best_perc", sep = "")',
'test_last_perc <- paste(test, "_Last_perc", sep = "")',
'test_athletes <- unique(data$NAME[!is.na(data[[test_current]])])',
'test_data <- full_data[full_data$NAME %in% test_athletes,]',
'split_data <- split(test_data[test], test_data$NAME)',
'#data[[test_best_perc]] <- data[[test_best_perc]] * 100',
'#data[[test_last_perc]] <- data[[test_last_perc]] * 100',
'data[!is.na(data[[test_current]]),] %>%',
'cbind("Trend" = "") %>%',
'select(',
'NAME,',
'Trend,',
'starts_with(test)) %>%',
'kable(',
'digits = 2,',
'row.names = FALSE,',
'col.names = c("Name",',
'"Trend",',
'"Current",',
'"Best",',
'"Best Change",',
'"Best % Change",',
'"Previous",',
'"Previous Change",',
'"Previous % Change"',
')',
') %>%',
'kable_styling(',
'full_width = TRUE,',
'fixed_thead = TRUE',
') %>%',
'column_spec(2, image = spec_plot(split_data, same_lim = FALSE))',
"```",
"",
""
), envir = environment(), quiet = TRUE)
})
?walk
# Create Table
file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_summary_data.csv'
, sep = '')
full_file_name <- paste(year(Sys.Date()), '_', month(Sys.Date()), '_testing_data.csv', sep = '')
data           <- read.csv(file = file_name)
athletes       <- unique(data$NAME)
full_data      <- read.csv(file = full_file_name)
full_data      <- full_data[full_data$NAME %in% athletes,] %>%
arrange(NAME) %>%
select(
NAME,
DATE,
starts_with(test)
)
View(full_data)
full_data$Date <- as.Date(full_data$DATE)
test_current <- paste(test, '_Current', sep = '')
test_best_perc <- paste(test, '_Best_perc', sep = '')
test_last_perc <- paste(test, '_Last_perc', sep = '')
test_athletes <- unique(data$Name[!is.na(data[[test_current]]])])
test_athletes <- unique(data$Name[!is.na(data[[test_current]])])
test_data <- full_data[full_data$NAME %in% test_athletes,]
split_data <- split(test_data[[test]], test_data$Name)
View(test_data)
test_data <- full_data[full_data$NAME %in% test_athletes,]
test_athletes <- unique(data$NAME[!is.na(data[[test_current]])])
test_data <- full_data[full_data$NAME %in% test_athletes,]
split_data <- split(test_data[[test]], test_data$Name)
split_data <- split(test_data[[test]], test_data$NAME)
View(data)
data[[test_best_perc]] <- data[[test_best_perc]] * 100
data[[test_last_perc]] <- data[[test_last_perc]] * 100
data[!is.na(data[[test_current]]),] %>%
cbind('Trend' = '') %>%
select(
Name,
Trend,
starts_with(test)) %>%
kable(
digits = 2,
row.names = FALSE,
col.names = c('Name',
'Trend',
'Current',
'Best',
'Best Change',
'Best % Change',
'Previous',
'Previous Change',
'Previous % Change'
)
) %>%
kable_styling(
full_width = TRUE,
fixed_thead = TRUE
) %>%
column_spec(2, image = spec_plot(split_data, same_lim = FALSE))
data[!is.na(data[[test_current]]),] %>%
cbind('Trend' = '') %>%
select(
NAME,
Trend,
starts_with(test)) %>%
kable(
digits = 2,
row.names = FALSE,
col.names = c('Name',
'Trend',
'Current',
'Best',
'Best Change',
'Best % Change',
'Previous',
'Previous Change',
'Previous % Change'
)
) %>%
kable_styling(
full_width = TRUE,
fixed_thead = TRUE
) %>%
column_spec(2, image = spec_plot(split_data, same_lim = FALSE))
?knit_child
#| output: asis
res <- purrr::map_chr(tests, \(hw) {
knitr::knit_child('Monthly Report Template.qmd', envir = environment(), quiet = TRUE)
})
#| output: asis
res <- purrr::map_chr(tests, \(hw) {
knitr::knit_child(input = 'Monthly Report Template.qmd', envir = environment(), quiet = TRUE)
})
knitr::knit_child(input = 'Monthly Report Template.qmd', quiet = TRUE)
#| output: asis
res <- purrr::map_chr(tests, \(hw) {
knitr::knit_child(input = 'Monthly Report Template.qmd', quiet = TRUE)
})
#| output: asis
res <- for (test in tests) {
knitr::knit_child(input = 'Monthly Report Template.qmd', quiet = TRUE)
}
#| output: asis
res <- for (test in tests) {
knitr::knit_child(input = 'Monthly Report Template.qmd', quiet = TRUE)
}
